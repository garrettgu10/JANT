(module (import "js" "secmem" (memory $secmem secret 512)) (import "js" "pubmem" (memory $pubmem 512)) (global $srsp (mut i32) (i32.const 33554432)) (global $prsp (mut i32) (i32.const 33554432))  (func $memcpy_sec_sec untrusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (s64.store 0 (i32.add (get_local $dest) (get_local $curr)) (s64.load 0 (i32.add (get_local $src) (get_local $curr)))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $memcpy_pub_pub untrusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (i64.store 1 (i32.add (get_local $dest) (get_local $curr)) (i64.load 1 (i32.add (get_local $src) (get_local $curr)))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $memcpy_pub_sec untrusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (s64.store 0 (i32.add (get_local $dest) (get_local $curr)) (s64.classify (i64.load 1 (i32.add (get_local $src) (get_local $curr))))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $memcpy_sec_pub trusted (param $src i32) (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (i64.store 1 (i32.add (get_local $dest) (get_local $curr)) (i64.declassify (s64.load 0 (i32.add (get_local $src) (get_local $curr))))) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $bzero_sec untrusted (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (s64.store 0 (i32.add (get_local $dest) (get_local $curr)) (s64.const 0)) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) ) (func $bzero_pub untrusted (param $dest i32) (param $nwords i32) (local $curr i32) (local $end i32) (set_local $curr (i32.const 0)) (set_local $end (i32.mul (get_local $nwords) (i32.const 8))) (block (loop (br_if 1 (i32.ge_u (get_local $curr) (get_local $end))) (i64.store 1 (i32.add (get_local $dest) (get_local $curr)) (i64.const 0)) (set_local $curr (i32.add (get_local $curr) (i32.const 8))) (br 0) ) ) )    (func $_crypto_core_salsa20 untrusted (param $__v37_output i32) (param $__v38_input i32) (param $__v39_k i32)  (local $__rctx s32) (local $__v40_x0 s32) (local $__v41_x5 s32) (local $__v42_x10 s32) (local $__v43_x15 s32) (local $__v44_j0 s32) (local $__v45_j5 s32) (local $__v46_j10 s32) (local $__v47_j15 s32) (local $__v97___load<32>_secret_le s32) (local $__v48_x1 s32) (local $__v98___load<32>_secret_le s32) (local $__v49_x2 s32) (local $__v99___load<32>_secret_le s32) (local $__v50_x3 s32) (local $__v100___load<32>_secret_le s32) (local $__v51_x4 s32) (local $__v101___load<32>_secret_le s32) (local $__v52_x11 s32) (local $__v102___load<32>_secret_le s32) (local $__v53_x12 s32) (local $__v103___load<32>_secret_le s32) (local $__v54_x13 s32) (local $__v104___load<32>_secret_le s32) (local $__v55_x14 s32) (local $__v56_j1 s32) (local $__v57_j2 s32) (local $__v58_j3 s32) (local $__v59_j4 s32) (local $__v60_j11 s32) (local $__v61_j12 s32) (local $__v62_j13 s32) (local $__v63_j14 s32) (local $__v105___load<32>_secret_le s32) (local $__v64_x6 s32) (local $__v106___load<32>_secret_le s32) (local $__v65_x7 s32) (local $__v107___load<32>_secret_le s32) (local $__v66_x8 s32) (local $__v108___load<32>_secret_le s32) (local $__v67_x9 s32) (local $__v68_j6 s32) (local $__v69_j7 s32) (local $__v70_j8 s32) (local $__v71_j9 s32) (local $__v72_i i32) (local $srbp i32) (local $prbp i32) (set_local $srbp (get_global $srsp)) (set_local $prbp (get_global $prsp)) (set_local $__rctx (s32.const 1)) (set_local $__v40_x0 (s32.const 1634760805)) (set_local $__v41_x5 (s32.const 857760878)) (set_local $__v42_x10 (s32.const 2036477234)) (set_local $__v43_x15 (s32.const 1797285236)) (set_local $__v44_j0 (get_local $__v40_x0)) (set_local $__v45_j5 (get_local $__v41_x5)) (set_local $__v46_j10 (get_local $__v42_x10)) (set_local $__v47_j15 (get_local $__v43_x15)) (set_local $__v97___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 0)))))) (set_local $__v48_x1 (get_local $__v97___load<32>_secret_le)) (set_local $__v98___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 4)))))) (set_local $__v49_x2 (get_local $__v98___load<32>_secret_le)) (set_local $__v99___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 8)))))) (set_local $__v50_x3 (get_local $__v99___load<32>_secret_le)) (set_local $__v100___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 12)))))) (set_local $__v51_x4 (get_local $__v100___load<32>_secret_le)) (set_local $__v101___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 16)))))) (set_local $__v52_x11 (get_local $__v101___load<32>_secret_le)) (set_local $__v102___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 20)))))) (set_local $__v53_x12 (get_local $__v102___load<32>_secret_le)) (set_local $__v103___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 24)))))) (set_local $__v54_x13 (get_local $__v103___load<32>_secret_le)) (set_local $__v104___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v39_k) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 28)))))) (set_local $__v55_x14 (get_local $__v104___load<32>_secret_le)) (set_local $__v56_j1 (get_local $__v48_x1)) (set_local $__v57_j2 (get_local $__v49_x2)) (set_local $__v58_j3 (get_local $__v50_x3)) (set_local $__v59_j4 (get_local $__v51_x4)) (set_local $__v60_j11 (get_local $__v52_x11)) (set_local $__v61_j12 (get_local $__v53_x12)) (set_local $__v62_j13 (get_local $__v54_x13)) (set_local $__v63_j14 (get_local $__v55_x14)) (set_local $__v105___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v38_input) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 0)))))) (set_local $__v64_x6 (get_local $__v105___load<32>_secret_le)) (set_local $__v106___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v38_input) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 4)))))) (set_local $__v65_x7 (get_local $__v106___load<32>_secret_le)) (set_local $__v107___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v38_input) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 8)))))) (set_local $__v66_x8 (get_local $__v107___load<32>_secret_le)) (set_local $__v108___load<32>_secret_le (s32.load 0 (i32.add (get_local $__v38_input) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 12)))))) (set_local $__v67_x9 (get_local $__v108___load<32>_secret_le)) (set_local $__v68_j6 (get_local $__v64_x6)) (set_local $__v69_j7 (get_local $__v65_x7)) (set_local $__v70_j8 (get_local $__v66_x8)) (set_local $__v71_j9 (get_local $__v67_x9))(set_local $__v72_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v72_i) (i32.const 10))) (set_local $__v51_x4 (s32.xor (get_local $__v51_x4) (s32.rotl (s32.add (get_local $__v40_x0) (get_local $__v53_x12)) (s32.const 7)))) (set_local $__v66_x8 (s32.xor (get_local $__v66_x8) (s32.rotl (s32.add (get_local $__v51_x4) (get_local $__v40_x0)) (s32.const 9)))) (set_local $__v53_x12 (s32.xor (get_local $__v53_x12) (s32.rotl (s32.add (get_local $__v66_x8) (get_local $__v51_x4)) (s32.const 13)))) (set_local $__v40_x0 (s32.xor (get_local $__v40_x0) (s32.rotl (s32.add (get_local $__v53_x12) (get_local $__v66_x8)) (s32.const 18)))) (set_local $__v67_x9 (s32.xor (get_local $__v67_x9) (s32.rotl (s32.add (get_local $__v41_x5) (get_local $__v48_x1)) (s32.const 7)))) (set_local $__v54_x13 (s32.xor (get_local $__v54_x13) (s32.rotl (s32.add (get_local $__v67_x9) (get_local $__v41_x5)) (s32.const 9)))) (set_local $__v48_x1 (s32.xor (get_local $__v48_x1) (s32.rotl (s32.add (get_local $__v54_x13) (get_local $__v67_x9)) (s32.const 13)))) (set_local $__v41_x5 (s32.xor (get_local $__v41_x5) (s32.rotl (s32.add (get_local $__v48_x1) (get_local $__v54_x13)) (s32.const 18)))) (set_local $__v55_x14 (s32.xor (get_local $__v55_x14) (s32.rotl (s32.add (get_local $__v42_x10) (get_local $__v64_x6)) (s32.const 7)))) (set_local $__v49_x2 (s32.xor (get_local $__v49_x2) (s32.rotl (s32.add (get_local $__v55_x14) (get_local $__v42_x10)) (s32.const 9)))) (set_local $__v64_x6 (s32.xor (get_local $__v64_x6) (s32.rotl (s32.add (get_local $__v49_x2) (get_local $__v55_x14)) (s32.const 13)))) (set_local $__v42_x10 (s32.xor (get_local $__v42_x10) (s32.rotl (s32.add (get_local $__v64_x6) (get_local $__v49_x2)) (s32.const 18)))) (set_local $__v50_x3 (s32.xor (get_local $__v50_x3) (s32.rotl (s32.add (get_local $__v43_x15) (get_local $__v52_x11)) (s32.const 7)))) (set_local $__v65_x7 (s32.xor (get_local $__v65_x7) (s32.rotl (s32.add (get_local $__v50_x3) (get_local $__v43_x15)) (s32.const 9)))) (set_local $__v52_x11 (s32.xor (get_local $__v52_x11) (s32.rotl (s32.add (get_local $__v65_x7) (get_local $__v50_x3)) (s32.const 13)))) (set_local $__v43_x15 (s32.xor (get_local $__v43_x15) (s32.rotl (s32.add (get_local $__v52_x11) (get_local $__v65_x7)) (s32.const 18)))) (set_local $__v48_x1 (s32.xor (get_local $__v48_x1) (s32.rotl (s32.add (get_local $__v40_x0) (get_local $__v50_x3)) (s32.const 7)))) (set_local $__v49_x2 (s32.xor (get_local $__v49_x2) (s32.rotl (s32.add (get_local $__v48_x1) (get_local $__v40_x0)) (s32.const 9)))) (set_local $__v50_x3 (s32.xor (get_local $__v50_x3) (s32.rotl (s32.add (get_local $__v49_x2) (get_local $__v48_x1)) (s32.const 13)))) (set_local $__v40_x0 (s32.xor (get_local $__v40_x0) (s32.rotl (s32.add (get_local $__v50_x3) (get_local $__v49_x2)) (s32.const 18)))) (set_local $__v64_x6 (s32.xor (get_local $__v64_x6) (s32.rotl (s32.add (get_local $__v41_x5) (get_local $__v51_x4)) (s32.const 7)))) (set_local $__v65_x7 (s32.xor (get_local $__v65_x7) (s32.rotl (s32.add (get_local $__v64_x6) (get_local $__v41_x5)) (s32.const 9)))) (set_local $__v51_x4 (s32.xor (get_local $__v51_x4) (s32.rotl (s32.add (get_local $__v65_x7) (get_local $__v64_x6)) (s32.const 13)))) (set_local $__v41_x5 (s32.xor (get_local $__v41_x5) (s32.rotl (s32.add (get_local $__v51_x4) (get_local $__v65_x7)) (s32.const 18)))) (set_local $__v52_x11 (s32.xor (get_local $__v52_x11) (s32.rotl (s32.add (get_local $__v42_x10) (get_local $__v67_x9)) (s32.const 7)))) (set_local $__v66_x8 (s32.xor (get_local $__v66_x8) (s32.rotl (s32.add (get_local $__v52_x11) (get_local $__v42_x10)) (s32.const 9)))) (set_local $__v67_x9 (s32.xor (get_local $__v67_x9) (s32.rotl (s32.add (get_local $__v66_x8) (get_local $__v52_x11)) (s32.const 13)))) (set_local $__v42_x10 (s32.xor (get_local $__v42_x10) (s32.rotl (s32.add (get_local $__v67_x9) (get_local $__v66_x8)) (s32.const 18)))) (set_local $__v53_x12 (s32.xor (get_local $__v53_x12) (s32.rotl (s32.add (get_local $__v43_x15) (get_local $__v55_x14)) (s32.const 7)))) (set_local $__v54_x13 (s32.xor (get_local $__v54_x13) (s32.rotl (s32.add (get_local $__v53_x12) (get_local $__v43_x15)) (s32.const 9)))) (set_local $__v55_x14 (s32.xor (get_local $__v55_x14) (s32.rotl (s32.add (get_local $__v54_x13) (get_local $__v53_x12)) (s32.const 13)))) (set_local $__v43_x15 (s32.xor (get_local $__v43_x15) (s32.rotl (s32.add (get_local $__v55_x14) (get_local $__v54_x13)) (s32.const 18)))) (set_local $__v72_i (i32.add (get_local $__v72_i) (i32.const 1))) (br 0)))(s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 0)))) (s32.add (get_local $__v40_x0) (get_local $__v44_j0))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 4)))) (s32.add (get_local $__v48_x1) (get_local $__v56_j1))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 8)))) (s32.add (get_local $__v49_x2) (get_local $__v57_j2))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 12)))) (s32.add (get_local $__v50_x3) (get_local $__v58_j3))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 16)))) (s32.add (get_local $__v51_x4) (get_local $__v59_j4))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 20)))) (s32.add (get_local $__v41_x5) (get_local $__v45_j5))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 24)))) (s32.add (get_local $__v64_x6) (get_local $__v68_j6))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 28)))) (s32.add (get_local $__v65_x7) (get_local $__v69_j7))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (s32.add (get_local $__v66_x8) (get_local $__v70_j8))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 36)))) (s32.add (get_local $__v67_x9) (get_local $__v71_j9))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 40)))) (s32.add (get_local $__v42_x10) (get_local $__v46_j10))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 44)))) (s32.add (get_local $__v52_x11) (get_local $__v60_j11))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 48)))) (s32.add (get_local $__v53_x12) (get_local $__v61_j12))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 52)))) (s32.add (get_local $__v54_x13) (get_local $__v62_j13))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 56)))) (s32.add (get_local $__v55_x14) (get_local $__v63_j14))) (s32.store 0 (i32.add (get_local $__v37_output) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 60)))) (s32.add (get_local $__v43_x15) (get_local $__v47_j15)))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return)(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp)) ) (func $_crypto_stream_salsa20 untrusted (param $__v23_c i32) (param $__v75___v23_c_len i64) (param $__v24_n i32) (param $__v25_k i32) (result i32) (local $__rval i32) (local $__rctx s32) (local $__v26_kcopy i32) (local $__v27_input i32) (local $__v28_i i32) (local $__v88_lexpr i64) (local $__v89_lexpr i64) (local $__v29_ctimes i32) (local $__v30_j i32) (local $__v90_lexpr i64) (local $__v31_u s32) (local $__v32_i i32) (local $__v91_lexpr i64) (local $__v92_lexpr i64) (local $__v33_block i32) (local $__v34_remain i32) (local $__v93_lexpr i64) (local $__v94_lexpr i64) (local $__v35_cview i32) (local $__v36_i i32) (local $__v95_lexpr i64) (local $__v96_lexpr i64) (local $srbp i32) (local $prbp i32) (set_local $srbp (get_global $srsp)) (set_local $prbp (get_global $prsp)) (set_local $__rval (i32.const 0)) (set_local $__rctx (s32.const 1))(if (i64.eq (get_local $__v75___v23_c_len) (i64.const 0)) (then (set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return (i32.const 0))) (else ))(set_local $__v26_kcopy (set_global $srsp (i32.sub (get_global $srsp) (i32.mul (i32.const 8) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (i32.const 8)))))(call $memcpy_sec_sec (get_local $__v25_k) (get_global $srsp) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (i32.const 8)))(get_global $srsp)) (set_local $__v27_input (set_global $srsp (i32.sub (get_global $srsp) (i32.mul (i32.const 8) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 16)))) (i32.const 8)))))(call $bzero_sec (get_global $srsp) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 16)))) (i32.const 8)))(get_global $srsp))(set_local $__v28_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v28_i) (i32.const 8))) (set_local $__v88_lexpr (i64.extend_i32_u (get_local $__v28_i))) (set_local $__v89_lexpr (i64.extend_i32_u (get_local $__v28_i))) (s32.store 0 (i32.add (get_local $__v27_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v88_lexpr)))) (s32.classify (i32.load 1 (i32.add (get_local $__v24_n) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v89_lexpr))))))) (set_local $__v28_i (i32.add (get_local $__v28_i) (i32.const 1))) (br 0)))(set_local $__v29_ctimes (i32.wrap_i64 (i64.shr_u (get_local $__v75___v23_c_len) (i64.const 6))))(set_local $__v30_j (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v30_j) (get_local $__v29_ctimes))) (set_local $__v90_lexpr (i64.extend_i32_u (i32.mul (get_local $__v30_j) (i32.const 64)))) (call $_crypto_core_salsa20 (i32.add (get_local $__v23_c) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v90_lexpr)))) (get_local $__v27_input) (get_local $__v26_kcopy)) (set_local $__v31_u (s32.const 1))(set_local $__v32_i (i32.const 8)) (block (loop (br_if 1 (i32.ge_u (get_local $__v32_i) (i32.const 16))) (set_local $__v91_lexpr (i64.extend_i32_u (get_local $__v32_i))) (set_local $__v31_u (s32.add (get_local $__v31_u) (s32.load 0 (i32.add (get_local $__v27_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v91_lexpr))))))) (set_local $__v92_lexpr (i64.extend_i32_u (get_local $__v32_i))) (s32.store 0 (i32.add (get_local $__v27_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v92_lexpr)))) (s32.and (s32.const 0xff) (get_local $__v31_u))) (set_local $__v31_u (s32.shr_u (get_local $__v31_u) (s32.const 8))) (set_local $__v32_i (i32.add (get_local $__v32_i) (i32.const 1))) (br 0))) (set_local $__v30_j (i32.add (get_local $__v30_j) (i32.const 1))) (br 0)))(set_local $__v33_block (set_global $srsp (i32.sub (get_global $srsp) (i32.mul (i32.const 8) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 64)))) (i32.const 8)))))(call $bzero_sec (get_global $srsp) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 64)))) (i32.const 8)))(get_global $srsp))(if (i64.lt_u (i64.extend_i32_u (i32.mul (get_local $__v29_ctimes) (i32.const 64))) (get_local $__v75___v23_c_len)) (then (call $_crypto_core_salsa20 (get_local $__v33_block) (get_local $__v27_input) (get_local $__v26_kcopy)) (set_local $__v34_remain (i32.wrap_i64 (i64.sub (get_local $__v75___v23_c_len) (i64.extend_i32_u (i32.mul (get_local $__v29_ctimes) (i32.const 64)))))) (set_local $__v93_lexpr (i64.extend_i32_u (i32.mul (get_local $__v29_ctimes) (i32.const 64)))) (set_local $__v94_lexpr (i64.extend_i32_u (get_local $__v34_remain))) (set_local $__v35_cview (i32.add (get_local $__v23_c) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v93_lexpr)))))(set_local $__v36_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v36_i) (get_local $__v34_remain))) (set_local $__v95_lexpr (i64.extend_i32_u (get_local $__v36_i))) (set_local $__v96_lexpr (i64.extend_i32_u (get_local $__v36_i))) (s32.store 0 (i32.add (get_local $__v35_cview) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v95_lexpr)))) (s32.load 0 (i32.add (get_local $__v33_block) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v96_lexpr)))))) (set_local $__v36_i (i32.add (get_local $__v36_i) (i32.const 1))) (br 0)))) (else ))(call $bzero_sec (get_local $__v33_block) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 64)))) (i32.const 8))) (call $bzero_sec (get_local $__v26_kcopy) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (i32.const 8)))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return (i32.const 0))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp)) ) (func $_crypto_stream_salsa20_xor_ic untrusted (param $__v1_c i32) (param $__v73___v1_c_len i64) (param $__v2_m i32) (param $__v74___v2_m_len i64) (param $__v3_n i32) (param $__v4_ic_val i64) (param $__v5_k i32) (result i32) (local $__rval i32) (local $__rctx s32) (local $__v6_ic i64) (local $__v7_kcopy i32) (local $__v8_input i32) (local $__v9_i i32) (local $__v76_lexpr i64) (local $__v77_lexpr i64) (local $__v10_i i32) (local $__v78_lexpr i64) (local $__v11_mtimes i64) (local $__v12_block i32) (local $__v13_j i64) (local $__v79_lexpr i64) (local $__v14_cview i32) (local $__v80_lexpr i64) (local $__v15_mview i32) (local $__v16_i i32) (local $__v81_lexpr i64) (local $__v82_lexpr i64) (local $__v83_lexpr i64) (local $__v17_u s32) (local $__v18_i i32) (local $__v84_lexpr i64) (local $__v85_lexpr i64) (local $__v19_remain i64) (local $__v86_lexpr i64) (local $__v20_cview i32) (local $__v87_lexpr i64) (local $__v21_mview i32) (local $__v22_i i64) (local $srbp i32) (local $prbp i32) (set_local $srbp (get_global $srsp)) (set_local $prbp (get_global $prsp)) (set_local $__rval (i32.const 0)) (set_local $__rctx (s32.const 1))(if (i64.eq (get_local $__v74___v2_m_len) (i64.const 0)) (then (set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return (i32.const 0))) (else )) (set_local $__v6_ic (get_local $__v4_ic_val)) (set_local $__v7_kcopy (set_global $srsp (i32.sub (get_global $srsp) (i32.mul (i32.const 8) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (i32.const 8)))))(call $memcpy_sec_sec (get_local $__v5_k) (get_global $srsp) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (i32.const 8)))(get_global $srsp)) (set_local $__v8_input (set_global $srsp (i32.sub (get_global $srsp) (i32.mul (i32.const 8) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 16)))) (i32.const 8)))))(call $bzero_sec (get_global $srsp) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 16)))) (i32.const 8)))(get_global $srsp))(set_local $__v9_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v9_i) (i32.const 8))) (set_local $__v76_lexpr (i64.extend_i32_u (get_local $__v9_i))) (set_local $__v77_lexpr (i64.extend_i32_u (get_local $__v9_i))) (s32.store 0 (i32.add (get_local $__v8_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v76_lexpr)))) (s32.load 0 (i32.add (get_local $__v3_n) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v77_lexpr)))))) (set_local $__v9_i (i32.add (get_local $__v9_i) (i32.const 1))) (br 0)))(set_local $__v10_i (i32.const 8)) (block (loop (br_if 1 (i32.ge_u (get_local $__v10_i) (i32.const 16))) (set_local $__v78_lexpr (i64.extend_i32_u (get_local $__v10_i))) (s32.store 0 (i32.add (get_local $__v8_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v78_lexpr)))) (s32.classify (i32.and (i32.ne (i32.and (i32.const 0xff) (i32.wrap_i64 (get_local $__v6_ic))) (i32.const 0)) (i32.ne (i32.const 255) (i32.const 0))))) (set_local $__v6_ic (i64.shr_u (get_local $__v6_ic) (i64.const 8))) (set_local $__v10_i (i32.add (get_local $__v10_i) (i32.const 1))) (br 0)))(set_local $__v11_mtimes (i64.div_u (get_local $__v74___v2_m_len) (i64.const 64))) (set_local $__v12_block (set_global $srsp (i32.sub (get_global $srsp) (i32.mul (i32.const 8) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 64)))) (i32.const 8)))))(call $bzero_sec (get_global $srsp) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 64)))) (i32.const 8)))(get_global $srsp))(set_local $__v13_j (i64.const 0)) (block (loop (br_if 1 (i64.ge_u (get_local $__v13_j) (get_local $__v11_mtimes))) (call $_crypto_core_salsa20 (get_local $__v12_block) (get_local $__v8_input) (get_local $__v7_kcopy)) (set_local $__v79_lexpr (i64.mul (get_local $__v13_j) (i64.const 64))) (set_local $__v14_cview (i32.add (get_local $__v1_c) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v79_lexpr))))) (set_local $__v80_lexpr (i64.mul (get_local $__v13_j) (i64.const 64))) (set_local $__v15_mview (i32.add (get_local $__v2_m) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v80_lexpr)))))(set_local $__v16_i (i32.const 0)) (block (loop (br_if 1 (i32.ge_u (get_local $__v16_i) (i32.const 64))) (set_local $__v81_lexpr (i64.extend_i32_u (get_local $__v16_i))) (set_local $__v82_lexpr (i64.extend_i32_u (get_local $__v16_i))) (set_local $__v83_lexpr (i64.extend_i32_u (get_local $__v16_i))) (s32.store 0 (i32.add (get_local $__v14_cview) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v81_lexpr)))) (s32.xor (s32.load 0 (i32.add (get_local $__v15_mview) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v82_lexpr))))) (s32.load 0 (i32.add (get_local $__v12_block) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v83_lexpr))))))) (set_local $__v16_i (i32.add (get_local $__v16_i) (i32.const 1))) (br 0)))(set_local $__v17_u (s32.const 1))(set_local $__v18_i (i32.const 8)) (block (loop (br_if 1 (i32.ge_u (get_local $__v18_i) (i32.const 16))) (set_local $__v84_lexpr (i64.extend_i32_u (get_local $__v18_i))) (set_local $__v17_u (s32.add (get_local $__v17_u) (s32.load 0 (i32.add (get_local $__v8_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v84_lexpr))))))) (set_local $__v85_lexpr (i64.extend_i32_u (get_local $__v18_i))) (s32.store 0 (i32.add (get_local $__v8_input) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v85_lexpr)))) (s32.and (s32.const 0xff) (get_local $__v17_u))) (set_local $__v17_u (s32.shr_u (get_local $__v17_u) (s32.const 8))) (set_local $__v18_i (i32.add (get_local $__v18_i) (i32.const 1))) (br 0))) (set_local $__v13_j (i64.add (get_local $__v13_j) (i64.const 1))) (br 0)))(if (i64.lt_u (i64.mul (get_local $__v11_mtimes) (i64.const 64)) (get_local $__v74___v2_m_len)) (then (set_local $__v19_remain (i64.sub (get_local $__v74___v2_m_len) (i64.mul (get_local $__v11_mtimes) (i64.const 64)))) (call $_crypto_core_salsa20 (get_local $__v12_block) (get_local $__v8_input) (get_local $__v7_kcopy)) (set_local $__v86_lexpr (i64.mul (get_local $__v11_mtimes) (i64.const 64))) (set_local $__v20_cview (i32.add (get_local $__v1_c) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v86_lexpr))))) (set_local $__v87_lexpr (i64.mul (get_local $__v11_mtimes) (i64.const 64))) (set_local $__v21_mview (i32.add (get_local $__v2_m) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v87_lexpr)))))(set_local $__v22_i (i64.const 0)) (block (loop (br_if 1 (i64.ge_u (get_local $__v22_i) (get_local $__v19_remain))) (s32.store 0 (i32.add (get_local $__v20_cview) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v22_i)))) (s32.xor (s32.load 0 (i32.add (get_local $__v21_mview) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v22_i))))) (s32.load 0 (i32.add (get_local $__v12_block) (i32.mul (i32.const 1) (i32.wrap_i64 (get_local $__v22_i))))))) (set_local $__v22_i (i64.add (get_local $__v22_i) (i64.const 1))) (br 0)))) (else ))(call $bzero_sec (get_local $__v12_block) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 64)))) (i32.const 8))) (call $bzero_sec (get_local $__v7_kcopy) (i32.div_u (i32.add (i32.const 7) (i32.mul (i32.const 1) (i32.wrap_i64 (i64.const 32)))) (i32.const 8)))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp))  (return (i32.const 0))(set_global $srsp (get_local $srbp)) (set_global $prsp (get_local $prbp)) )     )